<div class="user-form-container">
  <h2>{{ title() }}</h2>

  @if (error()) {
    <div class="error">{{ error() }}</div>
  }

  <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="firstName">Prénom *</label>
      <input
        id="firstName"
        type="text"
        formControlName="firstName"
        [class.error]="userForm.get('firstName')?.invalid && userForm.get('firstName')?.touched"
        maxlength="50"
      />
      @if (userForm.get('firstName')?.hasError('required') && userForm.get('firstName')?.touched) {
        <span class="error-message">Le prénom est requis</span>
      }
      @if (userForm.get('firstName')?.hasError('maxlength') && userForm.get('firstName')?.touched) {
        <span class="error-message">Le prénom ne doit pas dépasser 50 caractères</span>
      }
    </div>

    <div class="form-group">
      <label for="lastName">Nom *</label>
      <input
        id="lastName"
        type="text"
        formControlName="lastName"
        [class.error]="userForm.get('lastName')?.invalid && userForm.get('lastName')?.touched"
        maxlength="50"
      />
      @if (userForm.get('lastName')?.hasError('required') && userForm.get('lastName')?.touched) {
        <span class="error-message">Le nom est requis</span>
      }
      @if (userForm.get('lastName')?.hasError('maxlength') && userForm.get('lastName')?.touched) {
        <span class="error-message">Le nom ne doit pas dépasser 50 caractères</span>
      }
    </div>

    <div class="form-group">
      <label class="checkbox-label">
        <input type="checkbox" formControlName="isActive" />
        <span>Utilisateur actif</span>
      </label>
    </div>

    <div class="form-group">
      <label for="monthlyExpenseQuota">Quota mensuel de dépenses (€) *</label>
      <input
        id="monthlyExpenseQuota"
        type="number"
        formControlName="monthlyExpenseQuota"
        [class.error]="userForm.get('monthlyExpenseQuota')?.invalid && userForm.get('monthlyExpenseQuota')?.touched"
        step="0.01"
        min="0"
        placeholder="1000"
      />
      @if (userForm.get('monthlyExpenseQuota')?.hasError('required') && userForm.get('monthlyExpenseQuota')?.touched) {
        <span class="error-message">Le quota mensuel est requis</span>
      }
      @if (userForm.get('monthlyExpenseQuota')?.hasError('min') && userForm.get('monthlyExpenseQuota')?.touched) {
        <span class="error-message">Le quota doit être supérieur ou égal à 0</span>
      }
    </div>

    <div class="form-actions">
      <button type="button" class="btn-cancel" (click)="onCancel()" [disabled]="isSubmitting()">
        Annuler
      </button>
      <button type="submit" class="btn-submit" [disabled]="userForm.invalid || isSubmitting()">
        @if (isSubmitting()) {
          Enregistrement...
        } @else {
          {{ isEditMode() ? 'Modifier' : 'Créer' }}
        }
      </button>
    </div>
  </form>
</div>

